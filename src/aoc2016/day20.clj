(ns aoc2016.day20
  (:require [clojure.string :as str]
            [com.rpl.specter :as sp]
            [aoc2017.utils :as u]))

(defn parse-input
  [input]
  (->> input
    str/split-lines
    (mapv #(str/split % #"\-"))
    (sp/transform [sp/ALL sp/ALL] u/parse-long)))

(def ivs
  (parse-input "5-8\n0-2\n4-7"))

(defn in? [x [l h]]
  (<= l x h))

(defn part-1
  [ivs]
  (loop [x 0
         ivs (sort-by first ivs)]
    (let [containing (into [] (filter #(in? x %)) ivs)]
      (if (seq containing)
        (recur
          (->> containing (map second) (apply max) inc)
          (into [] (remove #(in? x %)) ivs))
        x))))

(part-1 ivs)

(defn overlap?
  [[l1 h1] [l2 h2]]
  (not
    (or
      (< h1 l2)
      (< h2 l1))))

(defn merge-ivs
  [[l1 h1] [l2 h2]]
  [(min l1 l2)
   (max h1 h2)])

(defn remove-overlaps
  [ivs]
  (loop [ivs (set ivs)]
    (if-let [[iv1 iv2]
             (first
               (for [iv1 ivs
                     iv2 ivs
                     :when (and
                             (not (identical? iv1 iv2))
                             (overlap? iv1 iv2))]
                 [iv1 iv2]))]
      (recur (-> ivs
               (disj iv1 iv2)
               (conj (merge-ivs iv1 iv2))))
      ivs
      )))

(defn part2
  [ivs]
  (-
    (inc 4294967295)
    (->> ivs
      remove-overlaps
      (map (fn [[l h]] (inc (- h l))))
      (apply +))
    ))

(comment

  (parse-input "1397985562-1399927095\n3833336583-3842601761\n155087348-169525214\n980790001-1002844256\n1977065361-1995466542\n36411396-50881439\n3640866817-3644930814\n2920060305-2932561292\n2865550534-2890593328\n3904139550-3908601694\n732092457-735186747\n1787486182-1806545011\n1491600386-1521258835\n2566773511-2568507598\n2201927929-2217336001\n948934267-952537088\n2146567862-2152339711\n3301828099-3306223909\n476027067-495966189\n2724939184-2726302873\n2270442513-2292973307\n1889038911-1895488302\n1578483230-1586330750\n2640456298-2651236024\n4254290660-4256486512\n1399927096-1421446962\n3253590561-3255525299\n4165315034-4173427102\n2875463797-2888803426\n3656533491-3659451752\n1995466544-2025204494\n3947779886-3987268039\n1521258837-1538635254\n735486056-744123494\n230221149-237996554\n3652971511-3653104884\n3019667516-3024190047\n969642901-977292032\n3645248112-3645595401\n3107902888-3148345903\n3202431537-3216963208\n1220746925-1223070151\n3267241325-3270573499\n903635659-931632639\n2847235008-2856948110\n4224654922-4236958325\n856464812-859836714\n1804748836-1825290046\n4082899236-4091369419\n953634177-954158487\n185823994-190243500\n1964052811-1976412955\n2420916052-2424566745\n953985134-954947310\n2584348542-2614406629\n2191157950-2198152569\n792721019-802271235\n3791161572-3800845341\n1864843815-1865425121\n1974124152-1989195256\n7825290-22939478\n440787397-441318113\n43830518-44800277\n3060173435-3065634268\n3165692093-3169381847\n1833191664-1858547431\n1931833201-1935239219\n57759373-67515020\n4113876528-4114024438\n1942285042-1951328312\n1604942683-1619936021\n853121890-865841853\n1837742103-1838104083\n3653104885-3680835942\n461163769-461467242\n3154277391-3159331043\n1689521647-1696389379\n4132416435-4154260806\n3575213588-3600527150\n962221692-989154668\n1935239220-1964052809\n853763614-856527667\n1529882226-1553729207\n2908870325-2931754108\n2317225465-2326207645\n550660010-557063544\n2362374340-2370047564\n3154439917-3169895876\n2971931902-2973888167\n3915276202-3919826635\n3443104535-3459421692\n2452320784-2463651682\n2645465344-2652262587\n623576471-624671363\n251678316-253256260\n3892899041-3898838343\n464002012-476960875\n3778510328-3794259788\n1032494594-1042075604\n1726869059-1729493515\n3050865580-3058403387\n4096451268-4105743850\n1794978532-1818366498\n1687963887-1693429657\n1919840326-1931792580\n3890085195-3896657673\n687727514-697989805\n2130251157-2132529361\n3709755147-3710261877\n2103854130-2136933959\n1240822471-1247567713\n2490928812-2517604025\n2792885084-2793563605\n4033319760-4037319553\n643767762-679821627\n2244191155-2263679816\n783204448-826857019\n874202754-876456673\n944792902-949779600\n1014490072-1020320091\n3709667893-3710060580\n3034067373-3060173434\n2380617387-2398492444\n3913418161-3925664598\n1327421559-1355573458\n2029296660-2060654925\n1015438314-1024776747\n758467105-766508249\n3196737715-3203535886\n4113219652-4113918216\n1900161068-1903498607\n737196603-742913680\n2762651281-2782581391\n1241724970-1273412553\n2234377553-2234408980\n3485475801-3485850742\n2823889184-2825719103\n546429220-552909166\n3889312069-3891497364\n1402469948-1411853934\n1612881279-1613899725\n609769932-611526589\n2821381184-2837715581\n2793443367-2793757783\n3865830130-3882113243\n2302840856-2330280758\n1587820493-1589487382\n1925168590-1930014298\n139238032-141721873\n3159767763-3165446614\n3124692923-3128639222\n2270740594-2281991663\n1338789977-1355677780\n1748641567-1751344173\n1416549076-1421417040\n4096185893-4097103352\n2627343873-2650750532\n3948622110-3962424399\n3734105837-3770337993\n557813236-573792261\n551603476-555886358\n1030836305-1032494592\n1839182718-1840151300\n833662859-842106273\n1375985004-1393778055\n1219332117-1221436570\n191846359-198587644\n984829875-987740125\n3262588159-3269982376\n4113255424-4114203177\n3754035901-3768277382\n182356017-189508231\n4235072872-4237128944\n2423845665-2424035634\n2247134633-2249391253\n1857070653-1864762228\n2960971255-2986516950\n3609807449-3629876533\n4232009521-4238664410\n2517604027-2532315540\n2284458125-2290950480\n1864762230-1865525184\n1534410012-1552842249\n1413197933-1418525745\n943004746-952141611\n3692615771-3699711756\n1641152229-1667111341\n3747007580-3765218619\n2379349853-2380702573\n2147254282-2171495074\n1839659452-1840812997\n3895746954-3895831312\n1969771475-1979046124\n3083853152-3107315352\n3503489045-3537546786\n2926162506-2931745365\n1533535067-1553811000\n4201206086-4201731554\n3151335418-3163702483\n3589540929-3593463200\n1469107231-1474901685\n1696389381-1748641566\n3910219915-3918863153\n3431523383-3432952214\n4219640842-4234037045\n2150930801-2173615229\n3364393582-3403187084\n3294593092-3301828098\n690072645-725395887\n1123029535-1135646014\n122125578-124303606\n4157086822-4157139009\n3561413702-3569934827\n3814389694-3815485217\n1931792582-1935186677\n3601713750-3623094300\n2322435284-2327697391\n1362099577-1366674586\n628898939-635522883\n3117359644-3135324932\n1119748429-1139457622\n3998554882-4014887284\n2837930003-2838092963\n2123885505-2126641084\n559576606-579617582\n2712491763-2723761235\n1391544337-1397769783\n3416595318-3422405875\n3403187085-3409221687\n1096346351-1099114997\n2703273295-2705328183\n4113785067-4113908859\n206706372-209083880\n3270160481-3271551430\n3285776930-3292794583\n461234099-461937747\n750957483-775003729\n4184090903-4204400455\n362276042-362676210\n4249953310-4250510076\n3477313433-3479866795\n3421127715-3428203812\n900263617-943004744\n835969757-836263940\n1368935057-1381717988\n149206242-166300349\n2154227228-2154605899\n1906507809-1919840325\n305745049-306370999\n1726861064-1728699678\n1357107426-1362288056\n799761595-801167452\n229374054-231369444\n1529834231-1535566821\n754999390-757160209\n1889190091-1897618002\n2138256423-2146567860\n2295710373-2336599718\n1019914990-1023404843\n969695821-980184547\n1443906340-1473362681\n833198360-836801840\n1598512205-1604942681\n3199387842-3210382637\n3895688557-3895758051\n1377900216-1382117658\n3504189983-3527083803\n3577792742-3598561740\n613575187-632091293\n2551456957-2551799726\n4058092124-4103653807\n3381308208-3381342063\n13984873-15227949\n1727002523-1727443872\n2357289728-2361812594\n3876054666-3879516291\n3278228783-3281894754\n1640252019-1649137061\n2372620720-2374166948\n4109383543-4110464683\n2069304258-2091857479\n4107063052-4115320079\n700724903-704038468\n2443015838-2445045788\n2487239190-2506741363\n2840932452-2854276703\n3023346911-3024737732\n855982891-864879970\n3794259789-3803801069\n500728802-502979928\n2043915271-2045977041\n2883286342-2889401600\n3645471325-3645615199\n2570503460-2572567939\n602978860-611682641\n3014237470-3019165777\n82763197-99917251\n3459591973-3480841023\n3726344670-3753436804\n778825357-781459133\n3501129290-3535003794\n2110603192-2124722020\n783458439-789801399\n3244733157-3257526606\n3107315354-3107902887\n3485245437-3487101327\n2981323037-2986657197\n4250870060-4262722661\n402547398-411983817\n1723037247-1732297154\n2168632715-2175630061\n35807058-48835050\n3967606126-3981776003\n1175337592-1177759663\n531093126-538642617\n3639437354-3641516465\n2313078075-2334991622\n2166324817-2172350995\n4271478996-4279496401\n4224492579-4228356386\n213570433-219586693\n3577738508-3578878626\n2004747361-2023251091\n638907979-651338734\n2042269899-2052960282\n3459421693-3470010193\n1255554697-1256876442\n547623253-554247422\n1091999863-1096115712\n3603876264-3620115458\n3743564125-3764787998\n1727097235-1727512693\n3360184134-3361837705\n2693328393-2699639043\n944625756-949285354\n2867948986-2885571238\n3815862045-3817192748\n85521215-90999860\n3492959364-3496450746\n2370047566-2373514273\n978064227-982934994\n3002922234-3034067371\n3702198906-3708772192\n1762248212-1777087215\n3200048313-3217284316\n310731268-314864040\n4256139187-4257030493\n4225267250-4242760473\n4236421277-4249953308\n456593320-464031864\n4173427103-4219640840\n3415471996-3417373524\n517786225-518353134\n2348225752-2349209975\n988767498-1002507583\n251787031-253294331\n2049843175-2053651832\n3272267359-3280700773\n1880334878-1897812119\n2180116083-2181662625\n1325501561-1332569991\n1977956589-1980243809\n1419475215-1429076341\n1571066989-1593324419\n1908591293-1926977363\n892862026-900263616\n2375708935-2420847226\n4252569311-4259706067\n611682642-636576980\n4069864506-4088316591\n3429899073-3443104533\n2881173909-2904242568\n838248538-839457347\n1040048945-1048427339\n2790325698-2817756908\n259065357-260284546\n4251177319-4254787503\n1727035024-1727220036\n1750189264-1751440819\n1182854783-1199103982\n1565110550-1598512204\n1870272544-1906507807\n2294404836-2313311754\n605934295-611508831\n3164119802-3167924307\n1833545461-1834287253\n2077509652-2090604632\n2880238444-2890262424\n1142031337-1148518669\n4005987455-4006591959\n1570054798-1576009746\n2071505543-2096650688\n3485106835-3485722365\n577813461-602978858\n2776866362-2786901141\n652895584-671838947\n3299449839-3300020065\n1623460193-1638054811\n3340666115-3353087971\n2160043893-2166478186\n1096507969-1101378526\n800088830-803013264\n13565145-17743483\n85024888-98806837\n3823224649-3827480049\n3931062541-3938277752\n1012892921-1030836304\n1565255853-1583189516\n1647708193-1660811906\n657010776-666847464\n1839278378-1840330117\n1008973854-1015912839\n1910283066-1913763928\n837557263-838411350\n1282815406-1288995029\n3980611-5584893\n3148345905-3165692092\n2742421263-2776592447\n229688447-231610502\n2743245719-2776866361\n3878098271-3883221309\n801316931-804135040\n1471664269-1473302685\n1667111343-1669791317\n1610947175-1617629889\n2003085048-2013051153\n3307457133-3360184133\n1195340209-1203343093\n2025204495-2028453665\n32923438-47156091\n3168696227-3170592073\n3235742576-3255614827\n2266729227-2280080556\n775349160-775813901\n1473362682-1482720843\n3572312385-3575213587\n528189743-538093910\n2448613175-2454994921\n2843283603-2855830818\n2890593329-2907911642\n153191907-164713586\n4043150608-4096451267\n605875663-610305444\n3021650-3111593\n2420847228-2420916051\n4105743852-4113419273\n2460397045-2462412256\n567585936-602788586\n1727082530-1727671255\n4033434900-4037286987\n4144511592-4162791978\n3075535768-3080851776\n1639907267-1641352662\n920282814-940069234\n3826936712-3829839713\n1916925688-1925357559\n1845213589-1860279111\n1854550234-1855331759\n3065495280-3066648567\n170353613-171186253\n3212824412-3220097963\n2853141261-2853700351\n3556640-3614471\n1976412956-1988224560\n3296627900-3297163117\n725395889-749479392\n2233996777-2234267091\n1757843247-1759325879\n4279435928-4280514617\n801130429-802441496\n3751681078-3760769957\n2347982977-2366662085\n4235682663-4235983270\n3496282296-3499776408\n3821333501-3824224274\n2723761236-2742421261\n2827790660-2835001032\n1935288812-1941728417\n1726855325-1728050569\n1726544710-1727430469\n3940016790-3941936080\n546101318-552097193\n4184013882-4199809831\n2425846522-2426458497\n3361306788-3362865310\n453108094-456181406\n860613212-892862024\n362299769-362572315\n17407637-23147236\n3504547466-3505717615\n985733821-987978530\n2735458050-2740276231\n270737999-279345075\n1787997707-1795677405\n3680835944-3709667892\n3818408771-3825605323\n16201770-24236234\n1158649495-1176112357\n952141612-961131855\n2690399120-2697050905\n2837757591-2838004534\n3487101328-3501129288\n3888980907-3889308041\n3139002312-3144216973\n1812389934-1832528171\n4062104130-4081249321\n4109985868-4116611691\n261499681-305729049\n414982559-415941657\n2837715582-2837939443\n1612314605-1613532579\n1847293843-1854555869\n2048771211-2052518908\n701565294-713634431\n208666820-210559343\n2827420738-2834300681\n4141218867-4154796647\n1970845509-1978651442\n1552842250-1565110548\n412226938-422230809\n596789633-599083332\n571536075-580257978\n4162791979-4165315032\n2578608882-2600367385\n2953753655-2967704893\n1620638998-1623460191\n3652181866-3653081107\n1226734954-1263413684\n208300600-209821102\n3019452277-3019912348\n1614701447-1620638997\n3941936081-3996282520\n3237157247-3249234449\n2348186235-2349807460\n3562813382-3565898388\n3710261879-3738818624\n2629772693-2635508362\n2443958025-2447376004\n399974274-423562472\n1778846705-1790086524\n2234646109-2266729225\n1668227842-1689521646\n3549361830-3564965209\n1286877599-1288249900\n2117171419-2125943104\n3620689032-3652181864\n3299261942-3299688775\n1490791491-1514099208\n3817192749-3833336581\n3410915712-3429899072\n541342032-546429219\n918411171-924314929\n2182745019-2185607312\n2212606518-2214621946\n1779983196-1804748835\n1936162035-1950945741\n3704618658-3705051939\n1764680564-1778846703\n2698697285-2709059938\n1326793529-1329535111\n3702328552-3704015912\n2008848662-2015608293\n1231732813-1247626190\n1750754899-1752420348\n1093229127-1099058712\n4234037046-4236997947\n3493552026-3497919102\n3235053958-3252106974\n4018470466-4036608102\n701727470-719544055\n574115703-596179511\n3202587506-3210265222\n698102469-706160479\n1832528173-1833853020\n441673267-452453492\n2911169435-2921998083\n2229856423-2234646108\n2196901664-2204841238\n1675352425-1691381949\n4250455374-4250513503\n3237515102-3260318492\n171161905-175877664\n2581539215-2596898898\n4004311193-4012385537\n1324083574-1324546090\n4096883078-4097164771\n780817620-784569858\n208242283-211110211\n1330525084-1336070077\n4008229513-4009226682\n834427868-838848257\n348999024-350410733\n467200453-500728800\n4121379695-4138903168\n2949401565-2976409803\n3917170902-3926057375\n3071781061-3074945017\n3299433864-3300019479\n3894069601-3909653487\n3741129648-3770933677\n1337537272-1347157874\n216818049-245842326\n1626689836-1641152228\n1112292760-1131928222\n1651219196-1654305795\n506374440-513152599\n430626871-453108093\n3297525469-3306042698\n3256944-3556639\n2937659849-2949401563\n3915476081-3917349752\n170273133-170386354\n3896834322-3906255111\n2911101673-2912870470\n2383625542-2388030504\n2202988069-2215864531\n3931566185-3938787313\n3893325063-3903409791\n1677593295-1694860962\n1726429432-1726959531\n550814749-553019695\n328183437-332828273\n2463651684-2490928811\n2532315541-2561777512\n902393943-906380753\n3255012511-3262588157\n464031865-471880579\n987894291-990856994\n2994108099-3016224261\n1464668452-1468573067\n3817599599-3819192240\n4281205900-4284988083\n1610485824-1614835930\n2922504894-2943149643\n1366674588-1391544336\n2716673569-2724196148\n2136933960-2141630673\n952929934-954132488\n102430362-103410808\n1097408788-1102041819\n1411884657-1413275434\n1569519099-1595018443\n3314630119-3351858696\n1159063633-1161383669\n1306210365-1310168207\n65606761-70210379\n969367195-1005028750\n305729050-305810398\n2964351925-2968998528\n2586831864-2598752947\n2717800067-2732550815\n1357733985-1357970980\n3142078167-3146050939\n836110255-836394578\n2855830819-2865550532\n1854118661-1854889002\n3275779087-3291457029\n481061771-497879373\n2572567941-2573814074\n3653825904-3656453968\n1752420350-1764680563\n3381301699-3381332932\n1499205864-1508841960\n2568948534-2571512127\n124303608-171161904\n834540652-842353886\n3296634137-3297348568\n756487393-757398433\n2920277931-2929967348\n775003730-775425950\n4006843235-4009222380\n4173461462-4180792939\n2573814075-2627343871\n3379943605-3385769428\n3613135813-3622915872\n456181408-463675190\n1679128363-1689145745\n1771462652-1775663407\n3896043704-3896601721\n3668521412-3670169542\n3189676166-3211906595\n4178058206-4197742264\n649282356-651528503\n4118830219-4151607552\n3403081369-3405163204\n1295416035-1327421558\n3535003795-3540392660\n2521028658-2521094946\n3378794770-3384471028\n3876141848-3885724936\n3415436447-3434089766\n3236961463-3242080308\n1289735149-1320942247\n20583890-31053879\n2039793197-2062178184\n3361173897-3362649522\n476445996-491796622\n2305715287-2337252117\n1407865145-1413213862\n100343325-122125577\n4259473250-4260027959\n1539624652-1558856769\n3388893007-3406562225\n3815438953-3819219050\n88644450-100343323\n2838092965-2853295826\n2298582785-2308283977\n1911552487-1924425897\n3486137486-3495337804\n3087487707-3105123828\n2449249575-2459990446\n1114195378-1147840884\n3084130783-3090098247\n280604127-291812349\n251655795-252002640\n2065738411-2068050329\n3540392662-3561413701\n4108709270-4110339849\n185357325-191846357\n2988550972-3002922233\n2008583503-2009174592\n367514957-375053863\n3738337-5109287\n2068050330-2103854128\n2185761689-2201113375\n502979929-541342030\n437711847-441825502\n763342493-770307022\n3891568242-3896055908\n2771403009-2783873057\n857296477-865365400\n2372996602-2415318753\n209779549-212434153\n3904992626-3910219913\n2976409804-2983591595\n3614472-4019606\n3429649651-3432451145\n2312224052-2330392688\n3889124925-3889312068\n3368044346-3369236254\n2485542419-2506962662\n3703774963-3704692844\n249324444-259065356\n3038718563-3063082755\n2348008128-2348750596\n4027659985-4040018381\n4020167637-4028011463\n631597603-638907977\n156806924-163856510\n465625162-475575707\n1653345924-1655794173\n644029368-673749955\n1342645425-1348056082\n754961620-757509941\n2185607313-2229856421\n2430693014-2452320783\n2423618253-2423991135\n2578007008-2593849390\n251455290-252167220\n2141431440-2145256393\n461551382-490688234\n1280627802-1282187341\n2447416346-2448485092\n801034819-803950109\n3803801071-3817168598\n2791159575-2797552524\n2444538618-2447695611\n3656900217-3658497760\n362424586-362913246\n2315692184-2318703938\n2658294991-2705851874\n758225777-762221309\n3220097965-3253590560\n3918863154-3937848140\n3842601762-3867989792\n1362989964-1365638761\n2669543622-2698580716\n204441701-216667513\n3337068522-3351226708\n2910214082-2911637865\n2887286425-2894235722\n2556506098-2564781736\n3660974732-3670236178\n3738818625-3765658510\n3926612436-3931754899\n849660339-860613211\n3878152839-3882588354\n1198564716-1203493708\n90563967-91509385\n4113419274-4118830217\n2421569872-2430693012\n1380512818-1382191639\n2171495075-2182745017\n2346496816-2347982976\n2773187116-2776527627\n3264380514-3275779086\n2795335811-2807483836\n1255625643-1259049524\n3039851327-3062062714\n3477125643-3485106833\n368161721-385647773\n557063546-567450813\n2662245837-2698867380\n409471723-415008368\n2692399192-2709671522\n3289361982-3294593090\n2444382077-2446243156\n995864334-1008973852\n1485359185-1511483438\n3170296689-3173219013\n651528504-684359142\n2799805080-2819283989\n2745894337-2761860632\n4021069786-4034189388\n2423235028-2423776100\n1161581883-1172788321\n575303235-584246627\n1323324671-1324380624\n423562473-430626869\n3173219015-3207487851\n256367467-256655264\n2729359684-2736808477\n2979779055-2988550970\n1482720845-1491600385\n1057830454-1067468142\n107593407-117739880\n251911362-252150667\n3569934829-3575123572\n2241251261-2263701349\n2726382705-2727247227\n4037319554-4043150606\n3718405500-3739070428\n2364203325-2366532950\n836023031-836878401\n961131857-995864333\n3961933297-3977917454\n3180447251-3212824411\n3124189059-3126106003\n793312386-802938899\n3873230388-3877536365\n2841402828-2852690950\n2931754109-2946377103\n4097161122-4098833023\n2953494240-2963922968\n1016080923-1023809512\n2305965588-2325470268\n1726429959-1728139098\n1725984972-1746517984\n2280080557-2294404834\n1453817212-1468119920\n3343366097-3354792825\n2726120736-2727168410\n1726047629-1726491275\n2425599810-2428632507\n1127809348-1136655248\n784569859-830872706\n3362865312-3399674855\n467374870-490345878\n2028166733-2029296658\n3793434985-3799550158\n4113324238-4114378130\n2768224805-2776292356\n3076910664-3083853151\n3795367294-3799559727\n983334314-985924731\n2566325429-2567644886\n2079828370-2095628301\n1355677782-1357107425\n3139807-3256943\n2297016509-2339606996\n3937987517-3940016788\n3111594-3180044\n3408799234-3410915710\n2736163676-2737085107\n2927299659-2930923781\n2828368238-2835482134\n2924361649-2933817173\n3278336262-3282205864\n209200196-211114889\n1089312986-1101840140\n2426098602-2426594407\n3761524602-3771101074\n4038400571-4039718550\n4278817904-4281979539\n1971790010-1982080495\n2482451447-2482859303\n696142504-708558552\n832751897-838668629\n522885199-537712867\n3854296653-3860724814\n4250257176-4250870059\n1098058891-1101871591\n2041494246-2044474847\n3379302636-3380200608\n2823631138-2825091086\n3114946479-3141035176\n2564781738-2570503459\n3066648569-3072839529\n2963998950-2966815574\n3996282522-4010140708\n2609189498-2612898027\n1398040334-1399196426\n2705851875-2712491761\n3303896197-3307457131\n3072710194-3078315569\n2650750533-2658294989\n125494120-152726161\n1799712687-1813651344\n4113647358-4114354821\n914689746-931400632\n2334991623-2346496814\n952020939-952231689\n3279484720-3279924084\n826369329-829381680\n306371001-356731744\n2545936899-2562194811\n755902693-769100113\n2423872436-2428440493\n1040252532-1043084518\n2531373947-2564360722\n3758158314-3765326552\n250882458-253102421\n2445299323-2451474922\n2845734926-2859990778\n2571586320-2571725933\n4010140709-4018470464\n1397769785-1398762710\n3812038748-3819957572\n2446738279-2447892957\n3600527152-3609409007\n260284548-271403358\n108405773-115248353\n1910315960-1918268562\n1323436354-1327278720\n2234068374-2234384404\n982370550-984890793\n362487749-363332785\n3703404287-3704710600\n511536791-531472470\n1204860806-1211356557\n1280824569-1283027536\n1864956505-1865664159\n1264539978-1280627800\n838668630-849660337\n1039302291-1048802154\n3820162182-3829891468\n252725400-258978812\n3811611218-3815532558\n5584894-20583889\n2571534738-2571657850\n383938370-391077230\n732225856-735643042\n2968582589-2972324720\n2379822184-2380941432\n775813903-782941501\n836283753-836553990\n2786901143-2790325697\n2907911644-2910586722\n3879031171-3883342655\n2446835992-2450584620\n3604970524-3620689031\n3656986634-3664253237\n108870276-116802953\n50881441-82763196\n830872708-834595234\n948787824-952327285\n3554278607-3558372901\n1411483095-1443906338\n1305613100-1306576996\n1171167570-1175215348\n145365808-166164576\n3344972328-3354937927\n178346121-180017093\n3487950867-3498067707\n3455826248-3468331688\n1357654405-1361499079\n2373804146-2375708934\n1682091088-1685006321\n2532666674-2554100432\n3872534964-3888980905\n684359144-690072644\n31053881-36411395\n749479393-750957481\n1233001829-1257233242\n1109953682-1114195377\n175877666-185357324\n1283027537-1289735147\n3374715947-3381800912\n1283434504-1286474690\n1402640030-1423128613\n1426046568-1440437597\n3021217411-3028438706\n3449839444-3455646128\n2192814747-2207353667\n1039244541-1044508076\n363332786-399974272\n620349463-624462815\n3118427268-3142548507\n1177759665-1219332116\n1223070153-1264539977\n2469319931-2491726485\n1101840141-1109953680\n1048427340-1089312984\n2577948853-2584544199\n43965520-47689181\n1833568506-1857070652\n356731745-362276040\n4262722663-4294967295\n2632338905-2641519671\n0-3021649\n1148518671-1158649494\n3562116150-3562242974\n567450814-585792807\n198587645-249324442\n3756871898-3778510326\n2815453754-2821381182\n3562113904-3562138636\n2567358294-2571273144\n2061605698-2065382934\n1865301101-1870272543\n2565458232-2569021972\n267026988-275785393\n2570888765-2571620263\n179248341-180073497\n267066134-277088479\n2060654926-2062597974\n2065382936-2066893485\n3298704119-3299564801\n2194534845-2218883408")

  (def ivs *1)

  (part2 ivs)

  )
